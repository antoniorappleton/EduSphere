<!doctype html>
<html lang="pt">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="../../styles.css" />
  <link rel="stylesheet" href="../../css/explicador.css" />

  <link rel="stylesheet" href="../../css/nav.css" />
  <title>EduSphere — Dashboard</title>

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.js"></script>
  <script src="../../public/js/supabaseClient.js"></script>
</head>

<body class="home has-footer-nav">

  <!-- MAIN CONTAINER (ADMIN STYLE) -->
  <section id="explPanel" class="expl-shell">

    <!-- NAVIGATION (SHARED) -->
    <nav id="explSidebarNav" class="expl-sidebar-nav">
      <button class="expl-nav-btn expl-nav-btn--active" onclick="location.href='dashboard.html'">
        <span class="expl-nav-icon">
          <svg class="expl-nav-svg" viewBox="0 0 24 24">
            <rect x="4" y="4" width="7" height="7" rx="1.5" />
            <rect x="13" y="4" width="7" height="7" rx="1.5" />
            <rect x="4" y="13" width="7" height="7" rx="1.5" />
            <rect x="13" y="13" width="7" height="7" rx="1.5" />
          </svg>
        </span>
        <span class="expl-nav-label">Dashboard</span>
      </button>

      <button class="expl-nav-btn" onclick="location.href='alunos.html'">
        <span class="expl-nav-icon">
          <svg class="expl-nav-svg" viewBox="0 0 24 24">
            <circle cx="12" cy="9" r="3.2" />
            <path d="M6.5 19.5c1.2-2.3 3-3.6 5.5-3.6s4.3 1.3 5.5 3.6" />
          </svg>
        </span>
        <span class="expl-nav-label">Alunos</span>
      </button>

      <button class="expl-nav-btn" onclick="location.href='calendario.html'">
        <span class="expl-nav-icon">
          <svg class="expl-nav-svg" viewBox="0 0 24 24">
            <rect x="4" y="5.5" width="16" height="14" rx="2" />
            <path d="M4 10h16" />
            <path d="M9 4v3" />
            <path d="M15 4v3" />
          </svg>
        </span>
        <span class="expl-nav-label">Calendário</span>
      </button>

      <button class="expl-nav-btn" onclick="location.href='faturacao.html'">
        <span class="expl-nav-icon">
          <svg class="expl-nav-svg" viewBox="0 0 24 24">
            <path d="M15.5 7.5c-1-.7-2.1-1.1-3.4-1.1-2.6 0-4.6 1.8-4.6 4.6s2 4.6 4.6 4.6c1.3 0 2.4-.4 3.4-1.1" />
            <path d="M11 5v14" />
          </svg>
        </span>
        <span class="expl-nav-label">Faturação</span>
      </button>

      <button class="expl-nav-btn" onclick="location.href='relatorios.html'">
        <span class="expl-nav-icon">
          <svg class="expl-nav-svg" viewBox="0 0 24 24">
            <path d="M4 18.5h16" />
            <path d="M6.5 15l3.2-4 3.2 2.7 4.1-5.2" />
            <path d="M16.8 8.5h3v3" />
          </svg>
        </span>
        <span class="expl-nav-label">Relatórios</span>
      </button>

      <div style="margin-top:auto">
        <button class="expl-nav-btn" id="btnLogoutNav" style="color:#ef4444">
          <span class="expl-nav-label">Sair</span>
        </button>
      </div>
    </nav>

    <!-- MAIN CONTENT -->
    <div class="expl-main">
      <header class="expl-header-bar" style="display:flex; justify-content:space-between; align-items:center;">
        <div class="expl-header-info">
          <h1 class="expl-page-title">Dashboard</h1>
          <p class="expl-hello-sub">Bem-vindo, <span id="expl-nome-header">Professor</span></p>
        </div>
        <button id="btnLogoutHeader" style="background:none; border:none; color:#ef4444; cursor:pointer;" title="Sair">
          <svg style="width:24px;height:24px" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
            <polyline points="16 17 21 12 16 7" />
            <line x1="21" y1="12" x2="9" y2="12" />
          </svg>
        </button>
      </header>

      <div class="expl-body">

        <!-- FINANCIAL SUMMARY -->
        <section class="dash-section">
          <h2 class="expl-section-title" style="color: #0f172a;">Resumo Financeiro</h2>
          <div class="expl-kpi-grid">
            <article class="expl-card expl-kpi-card">
              <p class="expl-kpi-label">Faturação Prevista</p>
              <p class="expl-kpi-value" id="card-total-previsto">€0,00</p>
            </article>

            <article class="expl-card expl-kpi-card">
              <p class="expl-kpi-label">Faturação Realizada</p>
              <p class="expl-kpi-value expl-kpi-value--green" id="card-total-mes">€0,00</p>
            </article>

            <article class="expl-card expl-kpi-card">
              <p class="expl-kpi-label">Pagamentos Pendentes</p>
              <p class="expl-kpi-value expl-kpi-value--red" id="card-pendentes">€0,00</p>
            </article>
          </div>
        </section>

        <!-- STUDENTS LIST -->
        <section class="dash-section" style="margin-top: 2rem;">
          <div class="expl-section-header" style="margin-bottom: 1rem;">
            <h2 class="expl-section-title" style="color: #0f172a;">
              Alunos <span id="dash-alunos-contador" style="color: #64748b; font-weight: 400; font-size: 0.95rem;">(0
                ativos)</span>
            </h2>
            <button class="expl-link-button" type="button" onclick="location.href='alunos.html'"
              style="color: #3b82f6; background: none; border: none; cursor: pointer; font-weight: 500;">
              Ver todos &rarr;
            </button>
          </div>

          <div class="dash-alunos-grid" id="dash-alunos-grid">
            <p style="color:#64748b">A carregar alunos...</p>
          </div>
        </section>

        <!-- CALENDAR & REPORTS -->
        <div class="dash-grid-split" style="display: grid; gap: 1rem; margin-top: 2rem;">
          <article class="expl-card dash-quick-card" onclick="location.href='calendario.html'" style="cursor: pointer;">
            <h3 class="expl-subsection-title">Calendário</h3>
            <p style="color: #64748b; font-size: 0.85rem; margin-bottom: 2rem;">Próximas explicações agendadas</p>
            <div style="display: flex; align-items: center; justify-content: center; color: #94a3b8; gap: 8px;">
              <span class="material-symbols-outlined">calendar_month</span>
              <span>Calendário de explicações</span>
            </div>
          </article>

          <article class="expl-card dash-quick-card" onclick="location.href='relatorios.html'" style="cursor: pointer;">
            <h3 class="expl-subsection-title">Relatórios</h3>
            <p style="color: #64748b; font-size: 0.85rem; margin-bottom: 2rem;">Estatísticas e análises</p>
            <div style="display: flex; align-items: center; justify-content: center; color: #94a3b8; gap: 8px;">
              <span class="material-symbols-outlined">trending_up</span>
              <span>Gráficos e estatísticas</span>
            </div>
          </article>
        </div>
      </div>
    </div>
    <!-- BOTTOM NAVIGATION (MOBILE) -->
    <nav class="app-footer-nav">
      <a href="dashboard.html" class="app-nav-item">
        <span class="material-symbols-outlined">grid_view</span>
        <span>Dashboard</span>
      </a>
      <a href="alunos.html" class="app-nav-item">
        <span class="material-symbols-outlined">group</span>
        <span>Alunos</span>
      </a>
      <a href="calendario.html" class="app-nav-item">
        <span class="material-symbols-outlined">calendar_month</span>
        <span>Calendário</span>
      </a>
      <a href="faturacao.html" class="app-nav-item">
        <span class="material-symbols-outlined">payments</span>
        <span>Faturação</span>
      </a>
      <a href="relatorios.html" class="app-nav-item">
        <span class="material-symbols-outlined">trending_up</span>
        <span>Relatórios</span>
      </a>
    </nav>
  </section>

  <!-- Navigation Logic -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" />
  <script src="../../public/js/nav.js"></script>

  <script src="../../public/js/explicador-service.js"></script>
  <script src="../../public/js/dashboard-explicador.js"></script>
</body>

</html>