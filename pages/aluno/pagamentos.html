<!doctype html>
<html lang="pt">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <link rel="stylesheet" href="../../css/base.css" />
  <link rel="stylesheet" href="../../css/aluno.css" />
  <link rel="stylesheet" href="../../css/explicador.css" />
  
  <title>EduSphere — Aluno Pagamentos</title>
  
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.js"></script>
  <script src="../../public/js/supabaseClient.js"></script>
</head>
<body class="home">

  <section class="expl-shell aluno-shell">
    
    <!-- MENU LATERAL -->
    <nav class="expl-sidebar-nav aluno-sidebar-nav">
      <button class="expl-nav-btn" onclick="location.href='dashboard.html'">
        <span class="expl-nav-icon"><svg class="expl-nav-svg" viewBox="0 0 24 24"><rect x="4" y="4" width="7" height="7" rx="1.5"/><rect x="13" y="4" width="7" height="7" rx="1.5"/><rect x="4" y="13" width="7" height="7" rx="1.5"/><rect x="13" y="13" width="7" height="7" rx="1.5"/></svg></span>
        <span class="expl-nav-label">Início</span>
      </button>

      <button class="expl-nav-btn" onclick="location.href='calendario.html'">
        <span class="expl-nav-icon"><svg class="expl-nav-svg" viewBox="0 0 24 24"><rect x="4" y="5.5" width="16" height="14" rx="2"/><path d="M4 10h16"/><path d="M9 4v3"/><path d="M15 4v3"/></svg></span>
        <span class="expl-nav-label">Calendário</span>
      </button>

      <button class="expl-nav-btn expl-nav-btn--active" onclick="location.href='pagamentos.html'">
        <span class="expl-nav-icon"><svg class="expl-nav-svg" viewBox="0 0 24 24"><path d="M7 8h7.5"/><path d="M7 12h6"/><path d="M10 4v16"/></svg></span>
        <span class="expl-nav-label">Pagamentos</span>
      </button>

      <div style="margin-top:auto">
         <button class="expl-nav-btn" id="btnLogoutNav" style="color:#ef4444">
           <span class="expl-nav-label">Sair</span>
         </button>
      </div>
    </nav>

    <!-- CONTENT -->
    <div class="expl-main">
      <div class="expl-body">
         <article class="expl-card pag-card">
            <h2 class="expl-section-title">Pagamentos</h2>
            <p class="expl-section-sub">Consulte o estado dos seus pagamentos</p>

            <div class="pag-resumo-grid">
               <!-- Cards... -->
               <div class="pag-resumo-card pag-resumo-card--total">
                  <p class="pag-resumo-label">Total Pago</p>
                  <p class="pag-resumo-valor pag-resumo-valor--green" id="pagTotalPago">€0,00</p>
               </div>
               
               <div class="pag-resumo-card pag-resumo-card--pendente">
                  <p class="pag-resumo-label">Valor Pendente</p>
                  <p class="pag-resumo-valor pag-resumo-valor--orange" id="pagValorPendente">€0,00</p>
               </div>
            </div>
         </article>

         <article class="expl-card" style="margin-top:2rem">
            <h3 class="expl-subsection-title">Histórico de Pagamentos</h3>
            <div class="table-wrapper">
               <table class="table table--wide pag-table">
                  <thead><tr><th>Mês</th><th>Valor</th><th>Data</th><th>Estado</th></tr></thead>
                  <tbody id="listaPagamentos"><tr><td colspan="4">A carregar...</td></tr></tbody>
               </table>
            </div>
         </article>
      </div>
    </div>
  </section>

  <script>
    document.getElementById('btnLogoutNav')?.addEventListener('click', async () => {
       await supabase.auth.signOut();
       location.href = '../../index.html';
    });

    (async () => {
       const { data: { session } } = await supabase.auth.getSession();
       if (!session) { location.href = '../../index.html'; return; }
       
       // ... Load Payments Logic stub
       document.getElementById('listaPagamentos').innerHTML = '<tr><td colspan="4">Sem registos.</td></tr>';
    })();
  </script>
</body>
</html>
